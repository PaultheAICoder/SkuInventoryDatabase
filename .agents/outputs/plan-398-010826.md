# Implementation Plan

**Issue**: #398 - Reorganize settings menu - separate admin from user settings
**Tier**: 2 (Standard)
**Type**: UI/UX Enhancement
**Est. Time**: 2-4 hours
**Category**: REFACTORING
**Test Strategy**: FAST_PATH (visual verification, no automated tests needed)

## Summary

Reorganize the sidebar navigation to separate company/brand-specific admin items (Locations, Brands, Categories, Companies, Vendors) into their own "Admin" section, while keeping user-level settings (General preferences) in a "Settings" section. This improves navigation clarity by distinguishing administrative management tasks from personal configuration settings.

## Current State

The current layout (`src/app/(dashboard)/layout.tsx`) has:

1. **Main Navigation** (lines 47-60): Dashboard, Components, SKUs, Transactions, Lots, Analytics, Forecasts, Shopify, SKU Mappings, Amazon, Recommendations, Change Log
2. **Settings Sub-Navigation** (lines 63-74): All settings mixed together:
   - General, Import, Users, Locations, Brands, Categories, Vendors, Companies, Integrations, Docker Health
3. **Single Collapsible Section**: Settings section is collapsible with admin-only visibility (line 168: `isAdminInAnyCompany`)
4. **Pattern Already Exists**: Collapsible section with chevron toggle (lines 170-188)

**Current `settingsNavigation` array:**
```typescript
const settingsNavigation = [
  { name: 'General', href: '/settings', icon: Settings },
  { name: 'Import', href: '/import', icon: Upload },
  { name: 'Users', href: '/settings/users', icon: Users },
  { name: 'Locations', href: '/settings/locations', icon: MapPin },
  { name: 'Brands', href: '/settings/brands', icon: Tag },
  { name: 'Categories', href: '/settings/categories', icon: FolderTree },
  { name: 'Vendors', href: '/settings/vendors', icon: Truck },
  { name: 'Companies', href: '/settings/companies', icon: Building2 },
  { name: 'Integrations', href: '/integrations', icon: Plug },
  { name: 'Docker Health', href: '/admin/docker-health', icon: Activity },
]
```

## Dependencies

None. This is a pure frontend reorganization with no database, API, or type changes required.

## Proposed Navigation Structure

### Admin Section (Admin-only, company/brand management)
| Item | Icon | Path | Notes |
|------|------|------|-------|
| Locations | MapPin | `/settings/locations` | Location management |
| Brands | Tag | `/settings/brands` | Brand management |
| Categories | FolderTree | `/settings/categories` | Category management |
| Companies | Building2 | `/settings/companies` | Company management |
| Vendors | Truck | `/settings/vendors` | Vendor management |
| Users | Users | `/settings/users` | User management |
| Import | Upload | `/import` | Data import (ops+ role) |
| Integrations | Plug | `/integrations` | External integrations |
| Docker Health | Activity | `/admin/docker-health` | System health |

### Settings Section (User-level, personal preferences)
| Item | Icon | Path | Notes |
|------|------|------|-------|
| General | Settings | `/settings` | Organization settings (company-level, but accessed by all) |

**NOTE**: Per issue description, future user-level items like "Dark Mode", "Profile", "Preferences" would go in Settings section. Currently only "General" exists as a placeholder.

## Changes Required

### Phase 1: Reorganize Navigation Arrays

| Subtask | File | Change | Completion Criteria |
|---------|------|--------|---------------------|
| 1.1 | `/home/pbrown/SkuInventory/src/app/(dashboard)/layout.tsx` | Split `settingsNavigation` into `adminNavigation` and `settingsNavigation` arrays | [ ] Two separate arrays defined |
| 1.2 | Same file | Add `adminOpen` state variable alongside existing `settingsOpen` | [ ] State variable added |
| 1.3 | Same file | Add `useEffect` to auto-expand Admin section when on admin paths | [ ] Auto-expand works for admin paths |

### Phase 2: Update Sidebar Rendering

| Subtask | File | Change | Completion Criteria |
|---------|------|--------|---------------------|
| 2.1 | `/home/pbrown/SkuInventory/src/app/(dashboard)/layout.tsx` | Create "Admin" collapsible section (copy existing Settings pattern) | [ ] Admin section renders with icon and chevron |
| 2.2 | Same file | Modify "Settings" collapsible section to use new `settingsNavigation` | [ ] Settings shows only user-level items |
| 2.3 | Same file | Ensure both sections have `isAdminInAnyCompany` visibility check | [ ] Both sections admin-only |

### Detailed Instructions

#### Subtask 1.1: Split Navigation Arrays

**File**: `/home/pbrown/SkuInventory/src/app/(dashboard)/layout.tsx`
**Lines**: 62-74

Replace the current `settingsNavigation` with two arrays:

```typescript
// Admin navigation items (company/brand management)
const adminNavigation = [
  { name: 'Locations', href: '/settings/locations', icon: MapPin },
  { name: 'Brands', href: '/settings/brands', icon: Tag },
  { name: 'Categories', href: '/settings/categories', icon: FolderTree },
  { name: 'Companies', href: '/settings/companies', icon: Building2 },
  { name: 'Vendors', href: '/settings/vendors', icon: Truck },
  { name: 'Users', href: '/settings/users', icon: Users },
  { name: 'Import', href: '/import', icon: Upload },
  { name: 'Integrations', href: '/integrations', icon: Plug },
  { name: 'Docker Health', href: '/admin/docker-health', icon: Activity },
]

// Settings sub-navigation items (user-level)
const settingsNavigation = [
  { name: 'General', href: '/settings', icon: Settings },
]
```

#### Subtask 1.2: Add State Variable

**File**: `/home/pbrown/SkuInventory/src/app/(dashboard)/layout.tsx`
**Line**: ~82

Add `adminOpen` state alongside `settingsOpen`:

```typescript
const [settingsOpen, setSettingsOpen] = useState(false)
const [adminOpen, setAdminOpen] = useState(false)  // Add this
```

#### Subtask 1.3: Update useEffect for Auto-Expand

**File**: `/home/pbrown/SkuInventory/src/app/(dashboard)/layout.tsx`
**Lines**: 88-95

Modify the useEffect to handle both sections:

```typescript
// Auto-expand admin/settings if current path is in those sections
useEffect(() => {
  const isAdminPath = adminNavigation.some(
    (item) => pathname === item.href || pathname.startsWith(item.href + '/')
  )
  const isSettingsPath = settingsNavigation.some(
    (item) => pathname === item.href || pathname.startsWith(item.href + '/')
  )
  if (isAdminPath) {
    setAdminOpen(true)
  }
  if (isSettingsPath) {
    setSettingsOpen(true)
  }
}, [pathname])
```

#### Subtask 2.1: Create Admin Collapsible Section

**File**: `/home/pbrown/SkuInventory/src/app/(dashboard)/layout.tsx`
**After**: Line 165 (after main navigation loop, before Settings section)

Add Admin collapsible section (copy pattern from existing Settings, lines 169-214):

```typescript
{/* Admin section (admin only) */}
{isAdminInAnyCompany && (
  <>
    <button
      onClick={() => setAdminOpen(!adminOpen)}
      className={cn(
        'flex items-center justify-between gap-3 rounded-md px-3 py-2 text-sm font-medium transition-colors w-full text-left',
        adminOpen
          ? 'bg-muted text-foreground'
          : 'text-muted-foreground hover:bg-muted hover:text-foreground'
      )}
    >
      <div className="flex items-center gap-3">
        <Building2 className="h-5 w-5" />
        Admin
      </div>
      {adminOpen ? (
        <ChevronDown className="h-4 w-4" />
      ) : (
        <ChevronRight className="h-4 w-4" />
      )}
    </button>

    {adminOpen && (
      <div className="ml-4 flex flex-col gap-1 border-l pl-2">
        {adminNavigation.map((item) => {
          const isActive = pathname === item.href || pathname.startsWith(item.href + '/')
          return (
            <Link
              key={item.name}
              href={item.href}
              className={cn(
                'flex items-center gap-3 rounded-md px-3 py-2 text-sm font-medium transition-colors',
                isActive
                  ? 'bg-primary text-primary-foreground'
                  : 'text-muted-foreground hover:bg-muted hover:text-foreground'
              )}
              onClick={() => setSidebarOpen(false)}
            >
              <item.icon className="h-4 w-4" />
              {item.name}
            </Link>
          )
        })}
      </div>
    )}
  </>
)}
```

#### Subtask 2.2: Modify Settings Section

The existing Settings section (lines 167-214) should remain mostly the same, but will now render only the user-level items since `settingsNavigation` array has been updated.

**Consideration**: Currently, Settings shows only "General". In the future, items like dark mode, profile, preferences would be added here. For now, this section may appear sparse but correctly separates concerns.

## Visual Hierarchy (Expected Result)

```
Inventory Tracker
[Company/Brand Selector]
--------------------------
Dashboard
Components
SKUs
Transactions
Lots
Analytics
Forecasts
Shopify (admin)
SKU Mappings (admin)
Amazon (admin)
Recommendations
Change Log
--------------------------
v Admin                    <- NEW (collapsible, admin-only)
  | Locations
  | Brands
  | Categories
  | Companies
  | Vendors
  | Users
  | Import
  | Integrations
  | Docker Health
v Settings                 <- EXISTING (modified, admin-only for now)
  | General
--------------------------
[User Info]
[Sign Out]
```

## Validation

- [ ] `npm run build` passes
- [ ] `npx tsc --noEmit` passes
- [ ] Admin section visible only to admin users
- [ ] Settings section visible only to admin users
- [ ] Both sections collapsible with chevron indicators
- [ ] Auto-expand works when navigating directly to an admin/settings page
- [ ] All existing functionality preserved (all links work)
- [ ] Mobile sidebar works correctly

## UI Acceptance Criteria

- [ ] Admin section appears between main nav and Settings section
- [ ] Admin section uses Building2 icon
- [ ] Settings section uses Settings icon (unchanged)
- [ ] Both sections have consistent styling (match existing Settings pattern)
- [ ] Chevron rotates on expand/collapse
- [ ] Visible on all screen sizes (no `lg:hidden` or similar)

## Files Summary

**Created**: 0
**Modified**: 1 - `/home/pbrown/SkuInventory/src/app/(dashboard)/layout.tsx`

## Notes

- The "General" settings page (`/settings`) currently contains company-level settings (inventory settings, display settings, quality alerts, expiry enforcement). While these are technically "organization settings" rather than "user settings", they remain in Settings for now as the only user-accessible configuration page.
- Future enhancement: Create dedicated user profile and preferences pages under Settings (dark mode, user profile, notification preferences).
- The issue mentions "Vendors (when added)" - Vendors were already added in issue #397 and are included in the current `settingsNavigation`.

## Risk Assessment

**Risk**: Low
- Pure frontend reorganization
- No database changes
- No API changes
- Pattern already exists in codebase
- Easy to revert if needed

---

**Generated**: 2026-01-08
**Generated By**: Scout-and-Plan Agent (combined workflow)
**Task ID**: #398
**Estimated Build Time**: 2-4 hours
**Complexity**: Low-Medium

## Performance Metrics

| Phase | Duration |
|-------|----------|
| Investigation | 8m |
| Validation | 2m |
| Planning | 5m |
| **Total** | **15m** |
