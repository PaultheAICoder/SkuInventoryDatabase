# Implementation Plan
**Generated**: 2025-12-31T10:00:00Z
**Generated By**: Scout-and-Plan Agent (combined workflow)
**Task ID**: GitHub Issue #335
**Estimated Build Time**: 1-2 hours
**Complexity**: Low

## Investigation Summary

### Request Analysis
**Type**: Bug (UX/Messaging Improvement)
**Source**: GitHub Issue #335
**Priority**: Medium

### Task Classification
**Category**: BUG_FIX
**Test Strategy**: FAST_PATH (smoke tests only - UI text changes)
**Suggested Filter**: None

### Issue Validation
**Status**: Valid
**Recent Changes**:
- `39f2e54` - feat: enable Shopify V2 features and reorganize sidebar navigation
- `1cd8685` - feat(issue #95): add order review queue UI

The Shopify order review feature was recently enabled. The "unmapped" terminology exists exactly as described in the issue.

### Current State Assessment

The word "unmapped" appears in user-facing UI in 3 key locations within the active codebase (excluding `_deferred/` which contains backup copies):

**Location 1: Orders List Table** (`/home/pbrown/SkuInventory/src/components/features/OrderReviewTable.tsx`)
- Line 47: Filter dropdown option `'Has Unmapped'`
- Line 188: Table cell displays `"{count} unmapped"` with warning icon

**Location 2: Order Detail Page** (`/home/pbrown/SkuInventory/src/components/features/OrderDetail.tsx`)
- Line 107: Badge displays `"Unmapped"` for line item status
- Line 191: Warning message says `"This order has unmapped line items. Map all items before approving."`

**Location 3: Types** (`/home/pbrown/SkuInventory/src/types/shopify-sync.ts`)
- Line 101: Type definition `mappingStatus: 'mapped' | 'unmapped' | 'not_found'`
- This is a code/data value, not user-facing text (do NOT change)

### The Mapping Concept Explained

When a Shopify order syncs:
1. Each order line has a Shopify product SKU (e.g., `FG-2-M`)
2. This Shopify SKU must be "mapped" to an internal inventory SKU
3. "Unmapped" means the Shopify SKU has NOT been linked to an internal SKU yet
4. Users must click "Map" to select which internal SKU corresponds to the Shopify product
5. Orders cannot be approved until all lines are mapped

### User Action Needed
The user needs to:
1. Click the "Map" button on the unmapped line
2. Select an internal SKU from the dropdown
3. Save the mapping

### Current vs Proposed Messaging

| Location | Current Text | Proposed Text | Rationale |
|----------|--------------|---------------|-----------|
| Orders list (count) | `"1 unmapped"` | `"1 needs SKU link"` | Action-oriented, explains what's needed |
| Filter dropdown | `"Has Unmapped"` | `"Needs SKU Link"` | Consistent terminology |
| Badge in detail | `"Unmapped"` | `"No SKU"` | Short, clear status |
| Warning message | `"This order has unmapped line items. Map all items before approving."` | `"Some products aren't linked to internal SKUs. Link all items before approving."` | Plain language, explains situation |

**Alternative terminology considered:**
- "Not linked" - good but slightly vague
- "SKU not mapped" - still uses confusing term
- "Link to internal SKU" - too long for badge
- "No SKU link" / "Needs SKU link" - clear and actionable

### Dependencies & Blockers
None. This is a pure UI text change.

**Can Proceed?**: YES

### Complexity Assessment
**Complexity**: Simple
**Effort**: 1-2 hours
**Risk**: Low (UI text changes only, no logic changes)

### Patterns Identified
**Primary**: The existing Badge component already has `variant="warning"` which is appropriate
**Secondary**: Filter dropdown follows standard shadcn/ui Select patterns

### Ripple Effect Analysis
**Files Affected**: 2
- `/home/pbrown/SkuInventory/src/components/features/OrderReviewTable.tsx` - Filter and table cell text
- `/home/pbrown/SkuInventory/src/components/features/OrderDetail.tsx` - Badge and warning message

**Note**: The `_deferred/` folder contains backup copies of these files that are NOT in active use. They do NOT need to be updated. The active codebase files under `src/components/features/` are the only ones that matter.

**Note**: The `mappingStatus` type value `'unmapped'` in `src/types/shopify-sync.ts` is a code/data identifier, NOT user-facing text. It should NOT be changed as it's used in:
- Database queries
- API responses
- Component logic

---

## Executive Summary

Update user-facing text in the Shopify order review UI to replace the confusing term "unmapped" with clearer messaging that explains users need to link Shopify products to internal SKUs. Changes are limited to 2 component files with no logic modifications.

## Phase 1: Update Orders List Table

### Subtask 1.1: Update Filter Dropdown Option Text
**File**: `/home/pbrown/SkuInventory/src/components/features/OrderReviewTable.tsx`
**Line**: 47
**Pattern**: Standard text string update

**Instructions**:
1. Locate the `UNMAPPED_OPTIONS` array at line 45-49
2. Change line 47 from:
   ```typescript
   { value: 'true', label: 'Has Unmapped' },
   ```
   to:
   ```typescript
   { value: 'true', label: 'Needs SKU Link' },
   ```

**Completion Criteria**:
- [ ] Filter dropdown shows "Needs SKU Link" instead of "Has Unmapped"
- [ ] TypeScript compiles without errors

### Subtask 1.2: Update Table Cell Display Text
**File**: `/home/pbrown/SkuInventory/src/components/features/OrderReviewTable.tsx`
**Line**: 188
**Pattern**: Standard text string update

**Instructions**:
1. Locate line 188 in the table row rendering
2. Change from:
   ```tsx
   <span className="text-sm">{unmappedCount} unmapped</span>
   ```
   to:
   ```tsx
   <span className="text-sm">{unmappedCount} needs SKU link</span>
   ```

**Completion Criteria**:
- [ ] Table shows "1 needs SKU link" (or appropriate count) instead of "1 unmapped"
- [ ] TypeScript compiles without errors

---

## Phase 2: Update Order Detail Page

### Subtask 2.1: Update Line Item Badge Text
**File**: `/home/pbrown/SkuInventory/src/components/features/OrderDetail.tsx`
**Line**: 107
**Pattern**: Standard text string update

**Instructions**:
1. Locate the `getMappingBadge` function (starts at line 99)
2. Change line 106-107 from:
   ```typescript
   case 'unmapped':
     return <Badge variant="warning">Unmapped</Badge>
   ```
   to:
   ```typescript
   case 'unmapped':
     return <Badge variant="warning">No SKU</Badge>
   ```

**Completion Criteria**:
- [ ] Badge shows "No SKU" instead of "Unmapped"
- [ ] TypeScript compiles without errors

### Subtask 2.2: Update Warning Banner Message
**File**: `/home/pbrown/SkuInventory/src/components/features/OrderDetail.tsx`
**Lines**: 190-192
**Pattern**: Standard text string update

**Instructions**:
1. Locate the warning banner at lines 187-194
2. Change lines 190-191 from:
   ```tsx
   <p className="text-sm text-yellow-800">
     This order has unmapped line items. Map all items before approving.
   </p>
   ```
   to:
   ```tsx
   <p className="text-sm text-yellow-800">
     Some products aren't linked to internal SKUs. Link all items before approving.
   </p>
   ```

**Completion Criteria**:
- [ ] Warning message uses clearer language
- [ ] TypeScript compiles without errors

---

## Phase 3: Verification

### Subtask 3.1: Build and Type Check
**Instructions**:
1. Run TypeScript check:
   ```bash
   npx tsc --noEmit
   ```
2. Run production build:
   ```bash
   npm run build
   ```

**Completion Criteria**:
- [ ] `npx tsc --noEmit` passes without errors
- [ ] `npm run build` completes successfully

### Subtask 3.2: Visual Verification (Optional - Manual)
**Instructions**:
1. Navigate to Shopify Orders page at `/shopify/orders`
2. Verify filter dropdown shows "Needs SKU Link" option
3. Verify any orders with unmapped items show "X needs SKU link"
4. Click into an order with unmapped items
5. Verify badge shows "No SKU" for unmapped line items
6. Verify warning banner text is updated

**Completion Criteria**:
- [ ] All text changes visible in UI
- [ ] Messaging is clearer and action-oriented

---

## Summary of Deliverables

**Files Created**: 0
**Files Modified**: 2

| File | Changes |
|------|---------|
| `/home/pbrown/SkuInventory/src/components/features/OrderReviewTable.tsx` | 2 text string updates (filter option + table cell) |
| `/home/pbrown/SkuInventory/src/components/features/OrderDetail.tsx` | 2 text string updates (badge + warning message) |

---

## Handoff to Build Agent

1. Execute subtasks in exact order (Phase 1 -> Phase 2 -> Phase 3)
2. Use exact text replacements specified
3. Verify TypeScript compiles after each file change
4. Run full build at the end

---

## Test Strategy Note

- **Category**: BUG_FIX (UX improvement)
- **Strategy**: FAST_PATH - No automated tests needed for text-only changes
- **Validation**: Manual visual check recommended but optional
- Build verification is sufficient for this change

---

## Files NOT to Modify

These files contain "unmapped" but should NOT be changed:

| File | Reason |
|------|--------|
| `src/types/shopify-sync.ts` | Contains type definition `mappingStatus: 'mapped' | 'unmapped' | 'not_found'` - this is a code value, not user text |
| `src/services/shopify-sync.ts` | Contains internal logic using `'unmapped'` status value |
| `src/services/order-posting.ts` | Contains internal logic referencing unmapped status |
| `src/app/api/shopify/orders/*.ts` | API routes using `'unmapped'` as data value |
| `src/_deferred/**` | Backup/deferred code not in active use |

---

## Performance Metrics

| Phase | Estimated Duration |
|-------|-------------------|
| Investigation | 15m |
| Validation | 5m |
| Planning | 10m |
| **Total Scout-Plan** | **30m** |
| **Estimated Build** | **30-60m** |
