# Implementation Plan

**Generated**: 2026-01-09
**Generated By**: Scout-and-Plan Agent (combined workflow)
**Task ID**: GitHub Issue #403
**Estimated Build Time**: 2-3 hours
**Complexity**: Low

## Investigation Summary

### Request Analysis
**Type**: Enhancement
**Source**: GitHub Issue #403
**Priority**: P3 (Enhancement)

### Task Classification
**Category**: UI/UX
**Test Strategy**: FAST_PATH (smoke tests only - UI label changes)
**Suggested Filter**: None

### Issue Validation
**Status**: Valid
**Recent Changes**: Multiple commits to transaction files in last 60 days, including transaction type improvements and photo upload capability. No conflicting changes.

### Current State Assessment
- **Transfers**: Already correctly show "From Location" and "To Location" in all views
- **Receipt/Outbound/Adjustment/Build**: All show generic "Location" which is ambiguous
- **Tables**: Transactions page and draft list show single "Location" column
- **Detail views**: TransactionDetail.tsx shows generic "Location" for non-transfer types
- **Forms**: QuickEntryForm, edit page, and ParsedTransactionPreview all use generic "Location" label

### Dependencies & Blockers
None - purely UI label changes with no database or API modifications.

**Can Proceed?**: YES

### Complexity Assessment
**Complexity**: Simple
**Effort**: 2-3 hours
**Risk**: Low - label-only changes, no logic changes

### Patterns Identified
**Primary**: Transfer transactions in `TransactionDetail.tsx` (lines 289-300) - shows "From Location" and "To Location" labels
**Secondary**: Edit page transfer handling (lines 664-705) - shows correctly labeled location fields

### Ripple Effect Analysis
**Files Identified**: 6
- `/home/pbrown/SkuInventory/src/app/(dashboard)/transactions/page.tsx` - Table header and filter label
- `/home/pbrown/SkuInventory/src/components/features/TransactionDetail.tsx` - Detail view location display
- `/home/pbrown/SkuInventory/src/app/(dashboard)/transactions/[id]/edit/page.tsx` - Edit form location field
- `/home/pbrown/SkuInventory/src/components/features/QuickEntryForm.tsx` - New transaction form
- `/home/pbrown/SkuInventory/src/components/features/ParsedTransactionPreview.tsx` - NL parser preview
- `/home/pbrown/SkuInventory/src/components/features/DraftTransactionList.tsx` - Draft list table header

---

## Executive Summary

Update location field labels across transaction forms and displays to clearly indicate whether a location is a source (where items ship from) or destination (where items are received). Receipt transactions will show "Destination Location", outbound transactions will show "Source Location", and transfer transactions already correctly show "From Location"/"To Location". This eliminates the ambiguous single "Location" label that causes user confusion.

---

## Phase 1: Transaction Detail View (Display)

### Subtask 1.1: Update TransactionDetail.tsx Location Display
**File**: `/home/pbrown/SkuInventory/src/components/features/TransactionDetail.tsx`
**Pattern**: Follow existing transfer handling at lines 289-300
**Instructions**:
1. Locate the generic location display block (lines 338-344)
2. Update the label logic to be transaction-type aware:
   - For `receipt` type: Display "Destination Location"
   - For `outbound` type: Display "Source Location"
   - For `build` and `adjustment` types: Keep "Location" (single location context is clear)
   - For `transfer`: Already handled separately with From/To
3. The current code:
   ```tsx
   {/* Location if present */}
   {transaction.location && (
     <div>
       <p className="text-sm text-muted-foreground">Location</p>
       <p className="font-medium">{transaction.location.name}</p>
     </div>
   )}
   ```
   Should become:
   ```tsx
   {/* Location if present */}
   {transaction.location && (
     <div>
       <p className="text-sm text-muted-foreground">
         {transaction.type === 'receipt'
           ? 'Destination Location'
           : transaction.type === 'outbound'
             ? 'Source Location'
             : 'Location'}
       </p>
       <p className="font-medium">{transaction.location.name}</p>
     </div>
   )}
   ```

**Completion Criteria**:
- [ ] Receipt transactions show "Destination Location"
- [ ] Outbound transactions show "Source Location"
- [ ] Build/adjustment transactions show "Location"
- [ ] Transfer continues to show From/To Location (no change)
- [ ] TypeScript compiles without errors

---

## Phase 2: Transaction Forms (Entry/Edit)

### Subtask 2.1: Update QuickEntryForm.tsx Inbound Location Label
**File**: `/home/pbrown/SkuInventory/src/components/features/QuickEntryForm.tsx`
**Pattern**: Standard label pattern in the form
**Instructions**:
1. Locate the inbound (receipt) form location field (around line 675)
2. Change label from "Location" to "Destination Location"
3. Update the current code:
   ```tsx
   <Label htmlFor="receipt-location" className="text-right">
     Location
   </Label>
   ```
   To:
   ```tsx
   <Label htmlFor="receipt-location" className="text-right">
     Destination Location
   </Label>
   ```

**Completion Criteria**:
- [ ] Inbound form shows "Destination Location" label
- [ ] Form continues to function correctly

### Subtask 2.2: Update QuickEntryForm.tsx Outbound Location Label
**File**: `/home/pbrown/SkuInventory/src/components/features/QuickEntryForm.tsx`
**Pattern**: Standard label pattern in the form
**Instructions**:
1. Locate the outbound form location field (around line 821)
2. Change label from "Location" to "Source Location"
3. Update the current code:
   ```tsx
   <Label htmlFor="outbound-location" className="text-right">
     Location
   </Label>
   ```
   To:
   ```tsx
   <Label htmlFor="outbound-location" className="text-right">
     Source Location
   </Label>
   ```

**Completion Criteria**:
- [ ] Outbound form shows "Source Location" label
- [ ] Form continues to function correctly

### Subtask 2.3: Update Edit Transaction Page Location Label
**File**: `/home/pbrown/SkuInventory/src/app/(dashboard)/transactions/[id]/edit/page.tsx`
**Pattern**: Follow existing transfer location handling (lines 664, 686)
**Instructions**:
1. Locate the common location field (around line 852)
2. Update the label to be transaction-type aware
3. The code is inside a block that excludes transfers (line 850: `transaction.type !== 'transfer'`)
4. Change:
   ```tsx
   <Label htmlFor="locationId" className="text-right">
     Location
   </Label>
   ```
   To:
   ```tsx
   <Label htmlFor="locationId" className="text-right">
     {transaction.type === 'receipt'
       ? 'Destination Location'
       : transaction.type === 'outbound'
         ? 'Source Location'
         : 'Location'}
   </Label>
   ```

**Completion Criteria**:
- [ ] Edit form shows context-appropriate location label
- [ ] Receipt shows "Destination Location"
- [ ] Outbound shows "Source Location"
- [ ] Build/adjustment show "Location"

### Subtask 2.4: Update ParsedTransactionPreview.tsx Location Label
**File**: `/home/pbrown/SkuInventory/src/components/features/ParsedTransactionPreview.tsx`
**Pattern**: Follow existing transaction type checks in the component
**Instructions**:
1. Locate the EditablePreviewField for Location (around line 385-395)
2. Update the label prop to be transaction-type aware
3. Change:
   ```tsx
   <EditablePreviewField
     label="Location"
     icon={<MapPin className="h-4 w-4" />}
     ...
   ```
   To:
   ```tsx
   <EditablePreviewField
     label={
       parsed.transactionType.value === 'receipt'
         ? 'Destination Location'
         : parsed.transactionType.value === 'outbound'
           ? 'Source Location'
           : 'Location'
     }
     icon={<MapPin className="h-4 w-4" />}
     ...
   ```

**Completion Criteria**:
- [ ] NL parser preview shows appropriate location label based on parsed transaction type
- [ ] Component continues to function correctly

---

## Phase 3: Transaction List Views

### Subtask 3.1: Update Transactions Page Table Header
**File**: `/home/pbrown/SkuInventory/src/app/(dashboard)/transactions/page.tsx`
**Pattern**: Current table display handles transfers with arrow notation (line 374-381)
**Instructions**:
1. The table header at line 340 shows generic "Location"
2. Since the table shows multiple transaction types mixed together, keeping a single "Location" column is appropriate
3. However, the location cell at lines 374-381 could add a visual indicator:
   - Current behavior correctly shows "A -> B" for transfers
   - For non-transfers, it shows just the location name
4. **Decision**: Keep the table header as "Location" since it's a mixed-type list
5. No change needed - the arrow notation for transfers already provides clarity
6. The filter label at line 298 should also remain "Location" since it filters by any location

**Completion Criteria**:
- [ ] Review confirmed - no changes needed for transaction list page
- [ ] Transfers continue to show "A -> B" format in the cell

### Subtask 3.2: Update DraftTransactionList.tsx Table Header
**File**: `/home/pbrown/SkuInventory/src/components/features/DraftTransactionList.tsx`
**Pattern**: Same as transactions page - mixed transaction types in table
**Instructions**:
1. The table header at line 290 shows "Location"
2. The display logic at lines 333-335 already handles transfers correctly with arrow notation
3. **Decision**: Keep as-is for same reason as transaction list page
4. No changes needed

**Completion Criteria**:
- [ ] Review confirmed - no changes needed for draft list
- [ ] Transfers continue to show arrow format in the cell

---

## Validation

**After completing all subtasks, run**:
```bash
npm run build
npx tsc --noEmit
npm run lint
```

All commands must pass without errors.

---

## Summary of Deliverables

**Files Created**: 0
**Files Modified**: 4
- `/home/pbrown/SkuInventory/src/components/features/TransactionDetail.tsx`
- `/home/pbrown/SkuInventory/src/components/features/QuickEntryForm.tsx`
- `/home/pbrown/SkuInventory/src/app/(dashboard)/transactions/[id]/edit/page.tsx`
- `/home/pbrown/SkuInventory/src/components/features/ParsedTransactionPreview.tsx`

**Files Reviewed (No Changes Needed)**: 2
- `/home/pbrown/SkuInventory/src/app/(dashboard)/transactions/page.tsx` - Mixed-type table, current behavior is appropriate
- `/home/pbrown/SkuInventory/src/components/features/DraftTransactionList.tsx` - Same reasoning

---

## Acceptance Criteria (from Issue)

- [x] Labels clearly indicate source vs destination - Subtasks 1.1, 2.1-2.4
- [x] Both locations shown in transaction detail when applicable - Already implemented for transfers
- [x] Transfer transactions show From and To locations - Already implemented, verified in investigation
- [x] No ambiguous "Location" labels - Receipt shows "Destination Location", Outbound shows "Source Location"

---

## Test Strategy Note

- Manual verification: Create receipt, outbound, and transfer transactions and verify labels display correctly
- Check edit forms for each transaction type
- Verify NL parser preview shows correct labels
- No automated tests needed for label-only changes

---

## Performance Metrics

| Phase | Duration |
|-------|----------|
| Investigation | 12m |
| Validation | 3m |
| Planning | 5m |
| **Total** | **20m** |
