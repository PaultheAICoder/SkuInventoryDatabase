# Quick Fix Plan

**Issue**: #410 - Apply fraction input support to ReceiptDialog.tsx cost field
**Tier**: 1 (Quick Fix)
**Type**: Enhancement
**Est. Time**: 30 minutes
**Generated**: 2026-01-09
**Generated By**: Scout-and-Plan Agent (combined workflow)

## The Fix

The ReceiptDialog.tsx cost input currently uses `type="number"` which prevents users from entering fraction values like "1/45" for cost per unit. Following the same pattern used in #394 (ComponentForm) and #406 (QuickEntryForm, FinishedGoodsReceiptDialog), we need to:
1. Change the input from `type="number"` to `type="text"`
2. Import and use `parseFractionOrNumber()` for parsing
3. Update the placeholder to indicate fraction support

## Investigation Summary

### Issue Validation
**Status**: Valid
**Recent Changes**: Issues #394 and #406 already fixed this pattern in other forms (ComponentForm.tsx, QuickEntryForm.tsx, FinishedGoodsReceiptDialog.tsx)
**Related Issues**: #394 (closed), #406 (closed)

### Current State Assessment
- **File**: `/home/pbrown/SkuInventory/src/components/features/ReceiptDialog.tsx`
- **Cost Input**: Lines 309-320 - uses `type="number" step="0.0001" min="0"`
- **Cost Parsing**: Line 133 - uses `parseFloat(formData.costPerUnit)`
- **Import**: Line 23 - only imports `toLocalDateString` from `@/lib/utils`

### Patterns Identified
**Primary Pattern File**: `/home/pbrown/SkuInventory/src/components/features/FinishedGoodsReceiptDialog.tsx`
- Line 22: `import { toLocalDateString, parseFractionOrNumber } from '@/lib/utils'`
- Line 98: `costPerUnit: formData.costPerUnit ? parseFractionOrNumber(formData.costPerUnit) ?? undefined : undefined`
- Lines 236-243: Input with `type="text"` and placeholder `"e.g., 0.02, 1/45 (blank = N/A)"`

**Secondary Pattern File**: `/home/pbrown/SkuInventory/src/components/features/QuickEntryForm.tsx`
- Line 21: Import includes `parseFractionOrNumber`
- Lines 459, 507: Same parsing pattern with null coalescing
- Lines 833-840: Same input pattern

### Task Classification
**Category**: ENHANCEMENT
**Test Strategy**: FAST_PATH (smoke tests only - simple UI change with well-tested utility function)
**Suggested Filter**: None

## Changes Required

| File | Line | Change |
|------|------|--------|
| `src/components/features/ReceiptDialog.tsx` | 23 | Add `parseFractionOrNumber` to import from `@/lib/utils` |
| `src/components/features/ReceiptDialog.tsx` | 133 | Replace `parseFloat(formData.costPerUnit)` with `parseFractionOrNumber(formData.costPerUnit) ?? undefined` |
| `src/components/features/ReceiptDialog.tsx` | 309-320 | Change input `type="number"` to `type="text"`, remove `step` and `min` attributes, update placeholder |

## Detailed Instructions

### Change 1: Update Import (Line 23)

**Current**:
```typescript
import { toLocalDateString } from '@/lib/utils'
```

**Replace with**:
```typescript
import { toLocalDateString, parseFractionOrNumber } from '@/lib/utils'
```

### Change 2: Update Cost Parsing (Line 133)

**Current**:
```typescript
costPerUnit: formData.costPerUnit ? parseFloat(formData.costPerUnit) : undefined,
```

**Replace with**:
```typescript
costPerUnit: formData.costPerUnit ? parseFractionOrNumber(formData.costPerUnit) ?? undefined : undefined,
```

### Change 3: Update Cost Input Field (Lines 309-320)

**Current**:
```tsx
<Input
  id="costPerUnit"
  type="number"
  step="0.0001"
  min="0"
  className="col-span-3"
  placeholder="Leave blank to use current cost"
  value={formData.costPerUnit}
  onChange={(e) =>
    setFormData((prev) => ({ ...prev, costPerUnit: e.target.value }))
  }
/>
```

**Replace with**:
```tsx
<Input
  id="costPerUnit"
  type="text"
  className="col-span-3"
  placeholder="e.g., 0.02, 1/45 (blank = N/A)"
  value={formData.costPerUnit}
  onChange={(e) =>
    setFormData((prev) => ({ ...prev, costPerUnit: e.target.value }))
  }
/>
```

## Validation

Run these commands after making changes:

```bash
# TypeScript check
npx tsc --noEmit

# Build check
npm run build

# Lint check
npm run lint
```

## Acceptance Criteria

- [ ] ReceiptDialog cost input changed from `type="number"` to `type="text"`
- [ ] ReceiptDialog uses `parseFractionOrNumber()` from `@/lib/utils` for cost parsing
- [ ] Input shows placeholder hint: `"e.g., 0.02, 1/45 (blank = N/A)"`
- [ ] `step` and `min` attributes removed from cost input
- [ ] Existing decimal inputs still work correctly (e.g., "0.02", "1.50")
- [ ] Fraction inputs work correctly (e.g., "1/45" = 0.022222...)
- [ ] `npm run build` passes without errors
- [ ] `npx tsc --noEmit` passes without errors

## Summary of Deliverables

**Files Created**: 0
**Files Modified**: 1
- `/home/pbrown/SkuInventory/src/components/features/ReceiptDialog.tsx`

## Performance Metrics

| Phase | Duration |
|-------|----------|
| Investigation | 3m |
| Validation | 1m |
| Planning | 2m |
| **Total** | **6m** |
